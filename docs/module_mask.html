<!DOCTYPE html>

<html :class="{'dark': darkMode === 'dark' || (darkMode === 'system' &amp;&amp; window.matchMedia('(prefers-color-scheme: dark)').matches)}" class="scroll-smooth" data-content_root="./" lang="en" x-data="{ darkMode: localStorage.getItem('darkMode') || localStorage.setItem('darkMode', 'system'), activeSection: '' }" x-init="$watch('darkMode', val =&gt; localStorage.setItem('darkMode', val))">
<head>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta charset="utf-8"/>
<meta content="white" media="(prefers-color-scheme: light)" name="theme-color"/>
<meta content="black" media="(prefers-color-scheme: dark)" name="theme-color"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Module decontamination.mask | decontamination 0.0.1 documentation</title>
<meta content="Module decontamination.mask | decontamination 0.0.1 documentation" property="og:title"/>
<meta content="Module decontamination.mask | decontamination 0.0.1 documentation" name="twitter:title"/>
<link href="_static/pygments.css?v=8d216cef" rel="stylesheet" type="text/css"/>
<link href="_static/theme.css?v=edd7d3d2" rel="stylesheet" type="text/css"/>
<link href="_static/docsearch.css?v=0bd54598" rel="stylesheet" type="text/css"/>
<link href="_static/custom.css?v=e712cdc3" rel="stylesheet" type="text/css"/>
<link href="_static/awesome-docsearch.css?v=851f3c4f" rel="stylesheet" type="text/css"/>
<link crossorigin="anonymous" href="https://-dsn.algolia.net" rel="preconnect"/>
<link href="genindex.html" rel="index" title="Index"/>
<link href="module_algo.html" rel="next" title="Module decontamination.algo"/>
<link href="module_hp.html" rel="prev" title="Module decontamination.hp"/>
<script>
    <!-- Prevent Flash of wrong theme -->
      const userPreference = localStorage.getItem('darkMode');
      let mode;
      if (userPreference === 'dark' || window.matchMedia('(prefers-color-scheme: dark)').matches) {
        mode = 'dark';
        document.documentElement.classList.add('dark');
      } else {
        mode = 'light';
      }
      if (!userPreference) {localStorage.setItem('darkMode', mode)}
    </script>
</head>
<body :class="{ 'overflow-hidden': showSidebar }" class="min-h-screen font-sans antialiased bg-background text-foreground" x-data="{ showSidebar: false, showScrollTop: false }">
<div @click.self="showSidebar = false" class="fixed inset-0 z-50 overflow-hidden bg-background/80 backdrop-blur-sm md:hidden" x-cloak="" x-show="showSidebar"></div><div class="relative flex flex-col min-h-screen" id="page"><a class="absolute top-0 left-0 z-[100] block bg-background p-4 text-xl transition -translate-x-full opacity-0 focus:translate-x-0 focus:opacity-100" href="#content">
      Skip to content
    </a><header class="sticky top-0 z-40 w-full border-b shadow-sm border-border supports-backdrop-blur:bg-background/60 bg-background/95 backdrop-blur"><div class="container flex items-center h-14">
<div class="hidden mr-4 md:flex">
<a class="flex items-center mr-6" href="index.html"><span class="hidden font-bold sm:inline-block text-clip whitespace-nowrap">decontamination 0.0.1 documentation</span>
</a></div><button @click="showSidebar = true" class="inline-flex items-center justify-center h-10 px-0 py-2 mr-2 text-base font-medium transition-colors rounded-md hover:text-accent-foreground hover:bg-transparent md:hidden" type="button">
<svg aria-hidden="true" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M152.587 825.087q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440Zm0-203.587q-19.152 0-32.326-13.174T107.087 576q0-19.152 13.174-32.326t32.326-13.174h320q19.152 0 32.326 13.174T518.087 576q0 19.152-13.174 32.326T472.587 621.5h-320Zm0-203.587q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440ZM708.913 576l112.174 112.174q12.674 12.674 12.674 31.826t-12.674 31.826Q808.413 764.5 789.261 764.5t-31.826-12.674l-144-144Q600 594.391 600 576t13.435-31.826l144-144q12.674-12.674 31.826-12.674t31.826 12.674q12.674 12.674 12.674 31.826t-12.674 31.826L708.913 576Z"></path>
</svg>
<span class="sr-only">Toggle navigation menu</span>
</button>
<div class="flex items-center justify-between flex-1 space-x-2 sm:space-x-4 md:justify-end">
<div class="flex-1 w-full md:w-auto md:flex-none"><div id="docsearch"></div>
</div>
<nav class="flex items-center space-x-1">
<button @click="darkMode = darkMode === 'light' ? 'dark' : 'light'" aria-label="Color theme switcher" class="relative inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md hover:bg-accent hover:text-accent-foreground h-9 w-9" type="button">
<svg class="absolute transition-all scale-100 rotate-0 dark:-rotate-90 dark:scale-0" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 685q45.456 0 77.228-31.772Q589 621.456 589 576q0-45.456-31.772-77.228Q525.456 467 480 467q-45.456 0-77.228 31.772Q371 530.544 371 576q0 45.456 31.772 77.228Q434.544 685 480 685Zm0 91q-83 0-141.5-58.5T280 576q0-83 58.5-141.5T480 376q83 0 141.5 58.5T680 576q0 83-58.5 141.5T480 776ZM80 621.5q-19.152 0-32.326-13.174T34.5 576q0-19.152 13.174-32.326T80 530.5h80q19.152 0 32.326 13.174T205.5 576q0 19.152-13.174 32.326T160 621.5H80Zm720 0q-19.152 0-32.326-13.174T754.5 576q0-19.152 13.174-32.326T800 530.5h80q19.152 0 32.326 13.174T925.5 576q0 19.152-13.174 32.326T880 621.5h-80Zm-320-320q-19.152 0-32.326-13.174T434.5 256v-80q0-19.152 13.174-32.326T480 130.5q19.152 0 32.326 13.174T525.5 176v80q0 19.152-13.174 32.326T480 301.5Zm0 720q-19.152 0-32.326-13.17Q434.5 995.152 434.5 976v-80q0-19.152 13.174-32.326T480 850.5q19.152 0 32.326 13.174T525.5 896v80q0 19.152-13.174 32.33-13.174 13.17-32.326 13.17ZM222.174 382.065l-43-42Q165.5 327.391 166 308.239t13.174-33.065q13.435-13.674 32.587-13.674t32.065 13.674l42.239 43q12.674 13.435 12.555 31.706-.12 18.272-12.555 31.946-12.674 13.674-31.445 13.413-18.772-.261-32.446-13.174Zm494 494.761-42.239-43q-12.674-13.435-12.674-32.087t12.674-31.565Q686.609 756.5 705.38 757q18.772.5 32.446 13.174l43 41.761Q794.5 824.609 794 843.761t-13.174 33.065Q767.391 890.5 748.239 890.5t-32.065-13.674Zm-42-494.761Q660.5 369.391 661 350.62q.5-18.772 13.174-32.446l41.761-43Q728.609 261.5 747.761 262t33.065 13.174q13.674 13.435 13.674 32.587t-13.674 32.065l-43 42.239q-13.435 12.674-31.706 12.555-18.272-.12-31.946-12.555Zm-495 494.761Q165.5 863.391 165.5 844.239t13.674-32.065l43-42.239q13.435-12.674 32.087-12.674t31.565 12.674Q299.5 782.609 299 801.38q-.5 18.772-13.174 32.446l-41.761 43Q231.391 890.5 212.239 890t-33.065-13.174ZM480 576Z"></path>
</svg>
<svg class="absolute transition-all scale-0 rotate-90 dark:rotate-0 dark:scale-100" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 936q-151 0-255.5-104.5T120 576q0-138 90-239.5T440 218q25-3 39 18t-1 44q-17 26-25.5 55t-8.5 61q0 90 63 153t153 63q31 0 61.5-9t54.5-25q21-14 43-1.5t19 39.5q-14 138-117.5 229T480 936Zm0-80q88 0 158-48.5T740 681q-20 5-40 8t-40 3q-123 0-209.5-86.5T364 396q0-20 3-40t8-40q-78 32-126.5 102T200 576q0 116 82 198t198 82Zm-10-270Z"></path>
</svg>
</button>
</nav>
</div>
</div>
</header>
<div class="flex-1"><div class="container flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[240px_minmax(0,1fr)] lg:gap-10"><aside :aria-hidden="!showSidebar" :class="{ 'translate-x-0': showSidebar }" class="fixed inset-y-0 left-0 md:top-14 z-50 md:z-30 bg-background md:bg-transparent transition-all duration-100 -translate-x-full md:translate-x-0 ml-0 p-6 md:p-0 md:-ml-2 md:h-[calc(100vh-3.5rem)] w-5/6 md:w-full shrink-0 overflow-y-auto border-r border-border md:sticky" id="left-sidebar">
<a class="!justify-start text-sm md:!hidden bg-background" href="index.html"><span class="font-bold text-clip whitespace-nowrap">decontamination 0.0.1 documentation</span>
</a>
<div class="relative overflow-hidden md:overflow-auto my-4 md:my-0 h-[calc(100vh-8rem)] md:h-auto">
<div class="overflow-y-auto h-full w-full relative pr-6"><div style="text-align: center; margin-right: 1.0rem; margin-bottom: 1.0rem;">
<a href="index.html">
<img alt="" src="_static/logo.png" width='100%"'/>
</a>
</div>
<h3><a href="index.html">Table of Contents</a></h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="module_jit.html">Module JIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_hp.html">Module HP</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Module Mask</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_algo.html">Module Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_plotting.html">Module Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_generator.html">Module Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_correlation.html">Module Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_decontamination.html">Module Decontamination</a></li>
</ul>
<div style="text-align: center; margin-right: 1.0rem; margin-top: 1rem;">
<a href="https://sonarqube.in2p3.fr/dashboard?id=decontamination-key" target="_blank">
<img alt="Sonar" src="https://sonarqube.in2p3.fr/api/project_badges/quality_gate?project=decontamination-key&amp;token=sqb_70baaf7c87542fe8555d5bd23fdb95bfaf848b37"/>
</a>
</div>
</div>
</div>
<button @click="showSidebar = false" class="absolute md:hidden right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100" type="button">
<svg class="h-4 w-4" fill="currentColor" height="24" stroke="none" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 632 284 828q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536 576l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480 632Z"></path>
</svg>
</button>
</aside>
<main class="relative py-6 lg:gap-10 lg:py-8 xl:grid xl:grid-cols-[1fr_300px]">
<div class="w-full min-w-0 mx-auto">
<nav aria-label="breadcrumbs" class="flex items-center mb-4 space-x-1 text-sm text-muted-foreground">
<a class="overflow-hidden text-ellipsis whitespace-nowrap hover:text-foreground" href="index.html">
<span class="hidden md:inline">decontamination 0.0.1 documentation</span>
<svg aria-label="Home" class="md:hidden" fill="currentColor" height="18" stroke="none" viewbox="0 96 960 960" width="18" xmlns="http://www.w3.org/2000/svg">
<path d="M240 856h120V616h240v240h120V496L480 316 240 496v360Zm-80 80V456l320-240 320 240v480H520V696h-80v240H160Zm320-350Z"></path>
</svg>
</a>
<div class="mr-1">/</div><span aria-current="page" class="font-medium text-foreground overflow-hidden text-ellipsis whitespace-nowrap">Module decontamination.mask</span>
</nav>
<div id="content" role="main">
<section id="module-decontamination-mask">
<h1>Module decontamination.mask<a class="headerlink" href="#module-decontamination-mask" title="Link to this heading"></a></h1>
<p>This module provides primitives to perform projection from image to HEALPix masks.</p>
<section id="module-decontamination.mask.healpix">
<span id="healpix-masks"></span><h2>HEALPix masks<a class="headerlink" href="#module-decontamination.mask.healpix" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#module-decontamination.mask.healpix'"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="decontamination.mask.healpix.rms_bit_to_healpix">
<span class="sig-prename descclassname"><span class="pre">decontamination.mask.healpix.</span></span><span class="sig-name descname"><span class="pre">rms_bit_to_healpix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#decontamination.mask.wcs.WCS" title="decontamination.mask.wcs.WCS"><span class="pre">WCS</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">footprint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rms_image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bit_image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rms_selection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bit_selection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress_bar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#decontamination.mask.healpix.rms_bit_to_healpix" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.healpix.rms_bit_to_healpix'"></a></dt>
<dd><p>Projects RMS (aka. noise) and bit (aka. data quality) images into a HEALPix footprint. <strong>Nested ordering only.</strong></p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>wcs</strong><span class="classifier">WCS</span></dt><dd><p>The WCS in HEALPix mode.</p>
</dd>
<dt><strong>nside</strong><span class="classifier">int</span></dt><dd><p>The HEALPix nside parameter.</p>
</dd>
<dt><strong>footprint</strong><span class="classifier">np.ndarray</span></dt><dd><p>HEALPix indices of the observed sky region.</p>
</dd>
<dt><strong>rms_image</strong><span class="classifier">np.ndarray</span></dt><dd><p>2d image containing the RMS (aka. noise) information.</p>
</dd>
<dt><strong>bit_image</strong><span class="classifier">np.ndarray, default: <strong>None</strong></span></dt><dd><p>2d image containing the bit (aka. data quality) information.</p>
</dd>
<dt><strong>rms_selection</strong><span class="classifier">float, default: <strong>1.0e4</strong></span></dt><dd><p>Reject the pixel if RMS == 0 or RMS &gt;= rms_selection.</p>
</dd>
<dt><strong>bit_selection</strong><span class="classifier">int, default: <strong>0x00</strong></span></dt><dd><p>Reject the pixel if (bit &amp; bit_selection) != 0x00.</p>
</dd>
<dt><strong>n_threads</strong><span class="classifier">int, default: 1</span></dt><dd><p>Number of threads.</p>
</dd>
<dt><strong>show_progress_bar</strong><span class="classifier">bool, default = <strong>False</strong></span></dt><dd><p>Specifies whether to display a progress bar.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>First array contains the RMS (aka. noise) mask.</p>
</dd>
<dt>np.ndarray</dt><dd><p>Second array contains the bit (aka. data quality) mask.</p>
</dd>
<dt>np.ndarray</dt><dd><p>Third array contains the coverage (≡ fraction of observed sky) mask.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="decontamination.mask.healpix.image_to_healpix">
<span class="sig-prename descclassname"><span class="pre">decontamination.mask.healpix.</span></span><span class="sig-name descname"><span class="pre">image_to_healpix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#decontamination.mask.wcs.WCS" title="decontamination.mask.wcs.WCS"><span class="pre">WCS</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">nside</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">footprint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xxx_image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xxx_image_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadratic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress_bar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#decontamination.mask.healpix.image_to_healpix" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.healpix.image_to_healpix'"></a></dt>
<dd><p>Projects the given image into a HEALPix footprint. <strong>Nested ordering only.</strong></p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>wcs</strong><span class="classifier">WCS</span></dt><dd><p>The WCS in HEALPix mode.</p>
</dd>
<dt><strong>nside</strong><span class="classifier">int</span></dt><dd><p>The HEALPix nside parameter.</p>
</dd>
<dt><strong>footprint</strong><span class="classifier">np.ndarray</span></dt><dd><p>HEALPix indices of the observed sky region.</p>
</dd>
<dt><strong>xxx_image</strong><span class="classifier">np.ndarray</span></dt><dd><p>2d image to be projected into the footprint.</p>
</dd>
<dt><strong>xxx_image_scale</strong><span class="classifier">int, default: <strong>1.0</strong></span></dt><dd><p>Scale so that the image size coincides with the WCS (&gt;= 1.0).</p>
</dd>
<dt><strong>quadratic</strong><span class="classifier">bool, default: False</span></dt><dd><p>???.</p>
</dd>
<dt><strong>n_threads</strong><span class="classifier">int, default: 1</span></dt><dd><p>Number of threads.</p>
</dd>
<dt><strong>show_progress_bar</strong><span class="classifier">bool, default = <strong>False</strong></span></dt><dd><p>Specifies whether to display a progress bar.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>The resulting HEALPix mask.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-decontamination.mask.moc">
<span id="multi-order-coverage-moc-masks"></span><h2>Multi-Order Coverage (MOC) masks<a class="headerlink" href="#module-decontamination.mask.moc" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#module-decontamination.mask.moc'"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="decontamination.mask.moc.order_index_to_nuniq">
<span class="sig-prename descclassname"><span class="pre">decontamination.mask.moc.</span></span><span class="sig-name descname"><span class="pre">order_index_to_nuniq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#decontamination.mask.moc.order_index_to_nuniq" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.moc.order_index_to_nuniq'"></a></dt>
<dd><p>Encodes HEALPix orders and pixel indices to unique identifiers (nuniq). <strong>Nested ordering only.</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>orders</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array of HEALPix orders.</p>
</dd>
<dt><strong>indices</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array of HEALPix pixel indices.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>Array of nuniq values for the given orders and pixel indices combinations.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="decontamination.mask.moc.nuniq_to_order_index">
<span class="sig-prename descclassname"><span class="pre">decontamination.mask.moc.</span></span><span class="sig-name descname"><span class="pre">nuniq_to_order_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nuniqs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#decontamination.mask.moc.nuniq_to_order_index" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.moc.nuniq_to_order_index'"></a></dt>
<dd><p>Decodes HEALPix nuniq identifiers to their corresponding orders and pixel indices. <strong>Nested ordering only.</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>nuniqs</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array of HEALPix nuniq identifiers.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>First array represents the HEALPix orders for the given nuniq values.</p>
</dd>
<dt>np.ndarray</dt><dd><p>Second array represents the HEALPix pixel indices for the given nuniq values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="decontamination.mask.moc.moc_to_healpix">
<span class="sig-prename descclassname"><span class="pre">decontamination.mask.moc.</span></span><span class="sig-name descname"><span class="pre">moc_to_healpix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moc_orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moc_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_new</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#decontamination.mask.moc.moc_to_healpix" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.moc.moc_to_healpix'"></a></dt>
<dd><p>Refines a given Multi-Order Coverage (MOC) to a specified order. <strong>Nested ordering only.</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>moc_orders</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array of HEALPix orders for each MOC cell.</p>
</dd>
<dt><strong>moc_indices</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array of HEALPix pixel indices for each MOC cell.</p>
</dd>
<dt><strong>order_new</strong><span class="classifier">int</span></dt><dd><p>The desired refinement order.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>Array of HEALPix pixel indices at the new order.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="decontamination.mask.moc.wmoc_to_healpix">
<span class="sig-prename descclassname"><span class="pre">decontamination.mask.moc.</span></span><span class="sig-name descname"><span class="pre">wmoc_to_healpix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moc_orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moc_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moc_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_new</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#decontamination.mask.moc.wmoc_to_healpix" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.moc.wmoc_to_healpix'"></a></dt>
<dd><p>Refines a given Weighted Multi-Order Coverage (WMOC) to a specified order. <strong>Nested ordering only.</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>moc_orders</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array of HEALPix orders for each MOC cell.</p>
</dd>
<dt><strong>moc_indices</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array of HEALPix pixel indices for each MOC cell.</p>
</dd>
<dt><strong>moc_weights</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array of associated values/weights for each MOC cell.</p>
</dd>
<dt><strong>order_new</strong><span class="classifier">int</span></dt><dd><p>The desired refinement order.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>First array contains the HEALPix pixel indices at the new order.</p>
</dd>
<dt>np.ndarray</dt><dd><p>Second array contains the associated values/weights at the new order.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-decontamination.mask.wcs">
<span id="world-coordinate-system-wcs"></span><h2>World Coordinate System (WCS)<a class="headerlink" href="#module-decontamination.mask.wcs" title="Link to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#module-decontamination.mask.wcs'"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">decontamination.mask.wcs.</span></span><span class="sig-name descname"><span class="pre">WCS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astropy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thread_safe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">healpix_convention</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS'"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">WCS</span></code></p>
<p>Thread-safe and HEALPix compliant World Coordinate System (WCS) inherited from <cite>astropy.wcs.WCS</cite> with additional features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>astropy</strong><span class="classifier">bool, default: False</span></dt><dd><p>???</p>
</dd>
<dt><strong>thread_safe</strong><span class="classifier">bool, default: False</span></dt><dd><p>???</p>
</dd>
<dt><strong>healpix_convention</strong><span class="classifier">bool, default: False</span></dt><dd><p>???</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">array_shape</span></code></dt><dd><p>The shape of the data that the WCS applies to as a tuple of length <cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim</cite> in <code class="docutils literal notranslate"><span class="pre">(row,</span> <span class="pre">column)</span></code> order (the convention for arrays in Python).</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">axis_correlation_matrix</span></code></dt><dd><p>Returns an (<cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim</cite>, <cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim</cite>) matrix that indicates using booleans whether a given world coordinate depends on a given pixel coordinate.</p>
</dd>
<dt><a class="reference internal" href="#decontamination.mask.wcs.WCS.axis_type_names" title="decontamination.mask.wcs.WCS.axis_type_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">axis_type_names</span></code></a></dt><dd><p>World names for each coordinate axis.</p>
</dd>
<dt><a class="reference internal" href="#decontamination.mask.wcs.WCS.celestial" title="decontamination.mask.wcs.WCS.celestial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">celestial</span></code></a></dt><dd><p>A copy of the current WCS with only the celestial axes included.</p>
</dd>
<dt><a class="reference internal" href="#decontamination.mask.wcs.WCS.cpdis1" title="decontamination.mask.wcs.WCS.cpdis1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpdis1</span></code></a></dt><dd><p><cite>~astropy.wcs.DistortionLookupTable</cite></p>
</dd>
<dt><a class="reference internal" href="#decontamination.mask.wcs.WCS.cpdis2" title="decontamination.mask.wcs.WCS.cpdis2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpdis2</span></code></a></dt><dd><p><cite>~astropy.wcs.DistortionLookupTable</cite></p>
</dd>
<dt><a class="reference internal" href="#decontamination.mask.wcs.WCS.det2im1" title="decontamination.mask.wcs.WCS.det2im1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">det2im1</span></code></a></dt><dd><p>A <cite>~astropy.wcs.DistortionLookupTable</cite> object for detector to image plane correction in the <em>x</em>-axis.</p>
</dd>
<dt><a class="reference internal" href="#decontamination.mask.wcs.WCS.det2im2" title="decontamination.mask.wcs.WCS.det2im2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">det2im2</span></code></a></dt><dd><p>A <cite>~astropy.wcs.DistortionLookupTable</cite> object for detector to image plane correction in the <em>y</em>-axis.</p>
</dd>
<dt><strong>has_celestial</strong></dt><dd></dd>
<dt><a class="reference internal" href="#decontamination.mask.wcs.WCS.has_distortion" title="decontamination.mask.wcs.WCS.has_distortion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_distortion</span></code></a></dt><dd><p>Returns <cite>True</cite> if any distortion terms are present.</p>
</dd>
<dt><strong>has_spectral</strong></dt><dd></dd>
<dt><strong>has_temporal</strong></dt><dd></dd>
<dt><strong>is_celestial</strong></dt><dd></dd>
<dt><strong>is_spectral</strong></dt><dd></dd>
<dt><strong>is_temporal</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">low_level_wcs</span></code></dt><dd><p>Returns a reference to the underlying low-level WCS object.</p>
</dd>
<dt><a class="reference internal" href="#decontamination.mask.wcs.WCS.pixel_axis_names" title="decontamination.mask.wcs.WCS.pixel_axis_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_axis_names</span></code></a></dt><dd><p>An iterable of strings describing the name for each pixel axis.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_bounds</span></code></dt><dd><p>The bounds (in pixel coordinates) inside which the WCS is defined, as a list with <cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim</cite> <code class="docutils literal notranslate"><span class="pre">(min,</span> <span class="pre">max)</span></code> tuples.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_n_dim</span></code></dt><dd><p>The number of axes in the pixel coordinate system.</p>
</dd>
<dt><strong>pixel_scale_matrix</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_shape</span></code></dt><dd><p>The shape of the data that the WCS applies to as a tuple of length <cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim</cite> in <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> order (where for an image, <code class="docutils literal notranslate"><span class="pre">x</span></code> is the horizontal coordinate and <code class="docutils literal notranslate"><span class="pre">y</span></code> is the vertical coordinate).</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">serialized_classes</span></code></dt><dd><p>Indicates whether Python objects are given in serialized form or as actual Python objects.</p>
</dd>
<dt><a class="reference internal" href="#decontamination.mask.wcs.WCS.sip" title="decontamination.mask.wcs.WCS.sip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sip</span></code></a></dt><dd><p>Get/set the <cite>~astropy.wcs.Sip</cite> object for performing <a href="#id4"><span class="problematic" id="id5">`SIP`_</span></a> distortion correction.</p>
</dd>
<dt><a class="reference internal" href="#decontamination.mask.wcs.WCS.spectral" title="decontamination.mask.wcs.WCS.spectral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spectral</span></code></a></dt><dd><p>A copy of the current WCS with only the spectral axes included.</p>
</dd>
<dt><a class="reference internal" href="#decontamination.mask.wcs.WCS.temporal" title="decontamination.mask.wcs.WCS.temporal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">temporal</span></code></a></dt><dd><p>A copy of the current WCS with only the time axes included.</p>
</dd>
<dt><a class="reference internal" href="#decontamination.mask.wcs.WCS.wcs" title="decontamination.mask.wcs.WCS.wcs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wcs</span></code></a></dt><dd><p>A <cite>~astropy.wcs.Wcsprm</cite> object to perform the basic <a href="#id6"><span class="problematic" id="id7">`wcslib`_</span></a> WCS transformation.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_axis_names</span></code></dt><dd><p>An iterable of strings describing the name for each world axis.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_axis_object_classes</span></code></dt><dd><p>A dictionary giving information on constructing high-level objects for the world coordinates.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_axis_object_components</span></code></dt><dd><p>A list with <cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim</cite> elements giving information on constructing high-level objects for the world coordinates.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_axis_physical_types</span></code></dt><dd><p>An iterable of strings describing the physical type for each world axis.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_axis_units</span></code></dt><dd><p>An iterable of strings given the units of the world coordinates for each axis.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_n_dim</span></code></dt><dd><p>The number of axes in the world coordinate system.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.all_pix2world" title="decontamination.mask.wcs.WCS.all_pix2world"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all_pix2world</span></code></a>(*args, **kwargs)</p></td>
<td><p>Thread-safe version of <cite>astropy.wcs.WCS.all_pix2world</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.all_world2pix" title="decontamination.mask.wcs.WCS.all_world2pix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all_world2pix</span></code></a>(*args, **kwargs)</p></td>
<td><p>Thread-safe version of <cite>astropy.wcs.WCS.all_world2pix</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.array_index_to_world" title="decontamination.mask.wcs.WCS.array_index_to_world"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array_index_to_world</span></code></a>(*index_arrays)</p></td>
<td><p>Convert array indices to world coordinates (represented by Astropy objects).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.array_index_to_world_values" title="decontamination.mask.wcs.WCS.array_index_to_world_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array_index_to_world_values</span></code></a>(*index_arrays)</p></td>
<td><p>Convert array indices to world coordinates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.calc_footprint" title="decontamination.mask.wcs.WCS.calc_footprint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_footprint</span></code></a>([header, undistort, axes, center])</p></td>
<td><p>Calculates the footprint of the image on the sky.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.copy" title="decontamination.mask.wcs.WCS.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Return a shallow copy of the object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.deepcopy" title="decontamination.mask.wcs.WCS.deepcopy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deepcopy</span></code></a>()</p></td>
<td><p>Return a deep copy of the object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.det2im" title="decontamination.mask.wcs.WCS.det2im"><code class="xref py py-obj docutils literal notranslate"><span class="pre">det2im</span></code></a>(*args)</p></td>
<td><p>Convert detector coordinates to image plane coordinates using <a href="#id8"><span class="problematic" id="id9">`distortion paper`_</span></a> table-lookup correction.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.dropaxis" title="decontamination.mask.wcs.WCS.dropaxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dropaxis</span></code></a>(dropax)</p></td>
<td><p>Remove an axis from the WCS.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.fix" title="decontamination.mask.wcs.WCS.fix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fix</span></code></a>([translate_units, naxis])</p></td>
<td><p>Perform the fix operations from wcslib, and warn about any changes it has made.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.footprint_contains" title="decontamination.mask.wcs.WCS.footprint_contains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">footprint_contains</span></code></a>(coord, **kwargs)</p></td>
<td><p>Determines if a given SkyCoord is contained in the wcs footprint.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.footprint_to_file" title="decontamination.mask.wcs.WCS.footprint_to_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">footprint_to_file</span></code></a>([filename, color, width, ...])</p></td>
<td><p>Writes out a <a href="#id10"><span class="problematic" id="id11">`ds9`_</span></a> style regions file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.get_axis_types" title="decontamination.mask.wcs.WCS.get_axis_types"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_axis_types</span></code></a>()</p></td>
<td><p>Similar to <cite>self.wcsprm.axis_types &lt;astropy.wcs.Wcsprm.axis_types&gt;</cite> but provides the information in a more Python-friendly format.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.p4_pix2foc" title="decontamination.mask.wcs.WCS.p4_pix2foc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">p4_pix2foc</span></code></a>(*args)</p></td>
<td><p>Convert pixel coordinates to focal plane coordinates using <a href="#id12"><span class="problematic" id="id13">`distortion paper`_</span></a> table-lookup correction.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.pix2foc" title="decontamination.mask.wcs.WCS.pix2foc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pix2foc</span></code></a>(*args)</p></td>
<td><p>Convert pixel coordinates to focal plane coordinates using the <a href="#id14"><span class="problematic" id="id15">`SIP`_</span></a> polynomial distortion convention and <a href="#id16"><span class="problematic" id="id17">`distortion paper`_</span></a> table-lookup correction.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_to_world</span></code>(*pixel_arrays)</p></td>
<td><p>Convert pixel coordinates to world coordinates (represented by high-level objects).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_to_world_values</span></code>(*pixel_arrays)</p></td>
<td><p>Convert pixel coordinates to world coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.proj_plane_pixel_area" title="decontamination.mask.wcs.WCS.proj_plane_pixel_area"><code class="xref py py-obj docutils literal notranslate"><span class="pre">proj_plane_pixel_area</span></code></a>()</p></td>
<td><p>For a <strong>celestial</strong> WCS (see <cite>astropy.wcs.WCS.celestial</cite>), returns pixel area of the image pixel at the <code class="docutils literal notranslate"><span class="pre">CRPIX</span></code> location once it is projected onto the "plane of intermediate world coordinates" as defined in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2002A%26A...395.1061G">Greisen &amp; Calabretta 2002, A&amp;A, 395, 1061</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.proj_plane_pixel_scales" title="decontamination.mask.wcs.WCS.proj_plane_pixel_scales"><code class="xref py py-obj docutils literal notranslate"><span class="pre">proj_plane_pixel_scales</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.reorient_celestial_first" title="decontamination.mask.wcs.WCS.reorient_celestial_first"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reorient_celestial_first</span></code></a>()</p></td>
<td><p>Reorient the WCS such that the celestial axes are first, followed by the spectral axis, followed by any others.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.sip_foc2pix" title="decontamination.mask.wcs.WCS.sip_foc2pix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sip_foc2pix</span></code></a>(*args)</p></td>
<td><p>Convert focal plane coordinates to pixel coordinates using the <a href="#id18"><span class="problematic" id="id19">`SIP`_</span></a> polynomial distortion convention.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.sip_pix2foc" title="decontamination.mask.wcs.WCS.sip_pix2foc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sip_pix2foc</span></code></a>(*args)</p></td>
<td><p>Convert pixel coordinates to focal plane coordinates using the <a href="#id20"><span class="problematic" id="id21">`SIP`_</span></a> polynomial distortion convention.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.slice" title="decontamination.mask.wcs.WCS.slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">slice</span></code></a>(view[, numpy_order])</p></td>
<td><p>Slice a WCS instance using a Numpy slice.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.sub" title="decontamination.mask.wcs.WCS.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sub</span></code></a>(axes)</p></td>
<td><p>Extracts the coordinate description for a subimage from a <cite>~astropy.wcs.WCS</cite> object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.swapaxes" title="decontamination.mask.wcs.WCS.swapaxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">swapaxes</span></code></a>(ax0, ax1)</p></td>
<td><p>Swap axes in a WCS.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.to_fits" title="decontamination.mask.wcs.WCS.to_fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_fits</span></code></a>([relax, key])</p></td>
<td><p>Generate an <cite>~astropy.io.fits.HDUList</cite> object with all of the information stored in this object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.to_header" title="decontamination.mask.wcs.WCS.to_header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_header</span></code></a>([relax, key])</p></td>
<td><p>Generate an <cite>astropy.io.fits.Header</cite> object with the basic WCS and SIP information stored in this object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.to_header_string" title="decontamination.mask.wcs.WCS.to_header_string"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_header_string</span></code></a>([relax])</p></td>
<td><p>Identical to <cite>to_header</cite>, but returns a string containing the header cards.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.wcs_pix2world" title="decontamination.mask.wcs.WCS.wcs_pix2world"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wcs_pix2world</span></code></a>(*args, **kwargs)</p></td>
<td><p>Transforms pixel coordinates to world coordinates by doing only the basic <a href="#id22"><span class="problematic" id="id23">`wcslib`_</span></a> transformation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.wcs_world2pix" title="decontamination.mask.wcs.WCS.wcs_world2pix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wcs_world2pix</span></code></a>(*args, **kwargs)</p></td>
<td><p>Transforms world coordinates to pixel coordinates, using only the basic <a href="#id24"><span class="problematic" id="id25">`wcslib`_</span></a> WCS transformation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.world_to_array_index" title="decontamination.mask.wcs.WCS.world_to_array_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_to_array_index</span></code></a>(*world_objects)</p></td>
<td><p>Convert world coordinates (represented by Astropy objects) to array indices.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#decontamination.mask.wcs.WCS.world_to_array_index_values" title="decontamination.mask.wcs.WCS.world_to_array_index_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_to_array_index_values</span></code></a>(*world_arrays)</p></td>
<td><p>Convert world coordinates to array indices.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_to_pixel</span></code>(*world_objects)</p></td>
<td><p>Convert world coordinates (represented by Astropy objects) to pixel coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_to_pixel_values</span></code>(*world_arrays)</p></td>
<td><p>Convert world coordinates to pixel coordinates.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>printwcs</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.MUTEX">
<span class="sig-name descname"><span class="pre">MUTEX</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;unlocked</span> <span class="pre">_thread.lock</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#decontamination.mask.wcs.WCS.MUTEX" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.MUTEX'"></a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.array_index_to_world">
<span class="sig-name descname"><span class="pre">array_index_to_world</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">index_arrays</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.array_index_to_world" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.array_index_to_world'"></a></dt>
<dd><p>Convert array indices to world coordinates (represented by Astropy
objects).</p>
<p>If a single high-level object is used to represent the world coordinates
(i.e., if <code class="docutils literal notranslate"><span class="pre">len(wcs.world_axis_object_classes)</span> <span class="pre">==</span> <span class="pre">1</span></code>), it is returned
as-is (not in a tuple/list), otherwise a tuple of high-level objects is
returned. See
<cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.array_index_to_world_values</cite> for
pixel indexing and ordering conventions.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.array_index_to_world_values">
<span class="sig-name descname"><span class="pre">array_index_to_world_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">index_arrays</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.array_index_to_world_values" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.array_index_to_world_values'"></a></dt>
<dd><p>Convert array indices to world coordinates.</p>
<p>This is the same as <cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_to_world_values</cite> except that
the indices should be given in <code class="docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">j)</span></code> order, where for an image
<code class="docutils literal notranslate"><span class="pre">i</span></code> is the row and <code class="docutils literal notranslate"><span class="pre">j</span></code> is the column (i.e. the opposite order to
<cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_to_world_values</cite>).</p>
<p>If <cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim</cite> is <code class="docutils literal notranslate"><span class="pre">1</span></code>, this
method returns a single scalar or array, otherwise a tuple of scalars or
arrays is returned.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.axis_type_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">axis_type_names</span></span><a class="headerlink" href="#decontamination.mask.wcs.WCS.axis_type_names" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.axis_type_names'"></a></dt>
<dd><p>World names for each coordinate axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>list of str</dt><dd><p>A list of names along each axis.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.calc_footprint">
<span class="sig-name descname"><span class="pre">calc_footprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">undistort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.calc_footprint" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.calc_footprint'"></a></dt>
<dd><p>Calculates the footprint of the image on the sky.</p>
<p>A footprint is defined as the positions of the corners of the
image on the sky after all available distortions have been
applied.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>header</strong><span class="classifier"><cite>~astropy.io.fits.Header</cite> object, optional</span></dt><dd><p>Used to get <code class="docutils literal notranslate"><span class="pre">NAXIS1</span></code> and <code class="docutils literal notranslate"><span class="pre">NAXIS2</span></code>
header and axes are mutually exclusive, alternative ways
to provide the same information.</p>
</dd>
<dt><strong>undistort</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>True</cite>, take SIP and distortion lookup table into
account</p>
</dd>
<dt><strong>axes</strong><span class="classifier">(int, int), optional</span></dt><dd><p>If provided, use the given sequence as the shape of the
image.  Otherwise, use the <code class="docutils literal notranslate"><span class="pre">NAXIS1</span></code> and <code class="docutils literal notranslate"><span class="pre">NAXIS2</span></code>
keywords from the header that was used to create this
<cite>WCS</cite> object.</p>
</dd>
<dt><strong>center</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>True</cite> use the center of the pixel, otherwise use the corner.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>coord</strong><span class="classifier">(4, 2) array of (<em>x</em>, <em>y</em>) coordinates.</span></dt><dd><p>The order is clockwise starting with the bottom left corner.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.celestial">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">celestial</span></span><a class="headerlink" href="#decontamination.mask.wcs.WCS.celestial" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.celestial'"></a></dt>
<dd><p>A copy of the current WCS with only the celestial axes included.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.copy" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.copy'"></a></dt>
<dd><p>Return a shallow copy of the object.</p>
<p>Convenience method so user doesn’t have to import the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">copy</span></code> stdlib module.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Use <cite>deepcopy</cite> instead of <cite>copy</cite> unless you know why you need a
shallow copy.</p>
</div>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.cpdis1">
<span class="sig-name descname"><span class="pre">cpdis1</span></span><a class="headerlink" href="#decontamination.mask.wcs.WCS.cpdis1" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.cpdis1'"></a></dt>
<dd><p><cite>~astropy.wcs.DistortionLookupTable</cite></p>
<p>The pre-linear transformation distortion lookup table, <code class="docutils literal notranslate"><span class="pre">CPDIS1</span></code>.</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.cpdis2">
<span class="sig-name descname"><span class="pre">cpdis2</span></span><a class="headerlink" href="#decontamination.mask.wcs.WCS.cpdis2" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.cpdis2'"></a></dt>
<dd><p><cite>~astropy.wcs.DistortionLookupTable</cite></p>
<p>The pre-linear transformation distortion lookup table, <code class="docutils literal notranslate"><span class="pre">CPDIS2</span></code>.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.deepcopy">
<span class="sig-name descname"><span class="pre">deepcopy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.deepcopy" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.deepcopy'"></a></dt>
<dd><p>Return a deep copy of the object.</p>
<p>Convenience method so user doesn’t have to import the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">copy</span></code> stdlib module.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.det2im">
<span class="sig-name descname"><span class="pre">det2im</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.det2im" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.det2im'"></a></dt>
<dd><p>Convert detector coordinates to image plane coordinates using
<a href="#id26"><span class="problematic" id="id27">`distortion paper`_</span></a> table-lookup correction.</p>
<p>The output is in absolute pixel coordinates, not relative to
<code class="docutils literal notranslate"><span class="pre">CRPIX</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>result</strong><span class="classifier">array</span></dt><dd><p>Returns the pixel coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>MemoryError</dt><dd><p>Memory allocation failed.</p>
</dd>
<dt>ValueError</dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.det2im1">
<span class="sig-name descname"><span class="pre">det2im1</span></span><a class="headerlink" href="#decontamination.mask.wcs.WCS.det2im1" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.det2im1'"></a></dt>
<dd><p>A <cite>~astropy.wcs.DistortionLookupTable</cite> object for detector to image plane
correction in the <em>x</em>-axis.</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.det2im2">
<span class="sig-name descname"><span class="pre">det2im2</span></span><a class="headerlink" href="#decontamination.mask.wcs.WCS.det2im2" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.det2im2'"></a></dt>
<dd><p>A <cite>~astropy.wcs.DistortionLookupTable</cite> object for detector to image plane
correction in the <em>y</em>-axis.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.dropaxis">
<span class="sig-name descname"><span class="pre">dropaxis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dropax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.dropaxis" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.dropaxis'"></a></dt>
<dd><p>Remove an axis from the WCS.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>wcs</strong><span class="classifier"><cite>~astropy.wcs.WCS</cite></span></dt><dd><p>The WCS with naxis to be chopped to naxis-1</p>
</dd>
<dt><strong>dropax</strong><span class="classifier">int</span></dt><dd><p>The index of the WCS to drop, counting from 0 (i.e., python convention,
not FITS convention)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><cite>~astropy.wcs.WCS</cite></dt><dd><p>A new <cite>~astropy.wcs.WCS</cite> instance with one axis fewer</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.fix">
<span class="sig-name descname"><span class="pre">fix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">translate_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">naxis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.fix" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.fix'"></a></dt>
<dd><p>Perform the fix operations from wcslib, and warn about any
changes it has made.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>translate_units</strong><span class="classifier">str, optional</span></dt><dd><p>Specify which potentially unsafe translations of
non-standard unit strings to perform.  By default,
performs none.</p>
<p>Although <code class="docutils literal notranslate"><span class="pre">"S"</span></code> is commonly used to represent seconds,
its translation to <code class="docutils literal notranslate"><span class="pre">"s"</span></code> is potentially unsafe since the
standard recognizes <code class="docutils literal notranslate"><span class="pre">"S"</span></code> formally as Siemens, however
rarely that may be used.  The same applies to <code class="docutils literal notranslate"><span class="pre">"H"</span></code> for
hours (Henry), and <code class="docutils literal notranslate"><span class="pre">"D"</span></code> for days (Debye).</p>
<p>This string controls what to do in such cases, and is
case-insensitive.</p>
<ul class="simple">
<li><p>If the string contains <code class="docutils literal notranslate"><span class="pre">"s"</span></code>, translate <code class="docutils literal notranslate"><span class="pre">"S"</span></code> to
<code class="docutils literal notranslate"><span class="pre">"s"</span></code>.</p></li>
<li><p>If the string contains <code class="docutils literal notranslate"><span class="pre">"h"</span></code>, translate <code class="docutils literal notranslate"><span class="pre">"H"</span></code> to
<code class="docutils literal notranslate"><span class="pre">"h"</span></code>.</p></li>
<li><p>If the string contains <code class="docutils literal notranslate"><span class="pre">"d"</span></code>, translate <code class="docutils literal notranslate"><span class="pre">"D"</span></code> to
<code class="docutils literal notranslate"><span class="pre">"d"</span></code>.</p></li>
</ul>
<p>Thus <code class="docutils literal notranslate"><span class="pre">''</span></code> doesn’t do any unsafe translations, whereas
<code class="docutils literal notranslate"><span class="pre">'shd'</span></code> does all of them.</p>
</dd>
<dt><strong>naxis</strong><span class="classifier">int array, optional</span></dt><dd><p>Image axis lengths.  If this array is set to zero or
<code class="docutils literal notranslate"><span class="pre">None</span></code>, then <cite>~astropy.wcs.Wcsprm.cylfix</cite> will not be
invoked.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.footprint_contains">
<span class="sig-name descname"><span class="pre">footprint_contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.footprint_contains" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.footprint_contains'"></a></dt>
<dd><p>Determines if a given SkyCoord is contained in the wcs footprint.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>coord</strong><span class="classifier"><cite>~astropy.coordinates.SkyCoord</cite></span></dt><dd><p>The coordinate to check if it is within the wcs coordinate.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional arguments to pass to <cite>~astropy.coordinates.SkyCoord.to_pixel</cite></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>response</strong><span class="classifier">bool</span></dt><dd><p>True means the WCS footprint contains the coordinate, False means it does not.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.footprint_to_file">
<span class="sig-name descname"><span class="pre">footprint_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'footprint.reg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'green'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordsys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.footprint_to_file" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.footprint_to_file'"></a></dt>
<dd><p>Writes out a <a href="#id28"><span class="problematic" id="id29">`ds9`_</span></a> style regions file. It can be loaded
directly by <a href="#id30"><span class="problematic" id="id31">`ds9`_</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str, optional</span></dt><dd><p>Output file name - default is <code class="docutils literal notranslate"><span class="pre">'footprint.reg'</span></code></p>
</dd>
<dt><strong>color</strong><span class="classifier">str, optional</span></dt><dd><p>Color to use when plotting the line.</p>
</dd>
<dt><strong>width</strong><span class="classifier">int, optional</span></dt><dd><p>Width of the region line.</p>
</dd>
<dt><strong>coordsys</strong><span class="classifier">str, optional</span></dt><dd><p>Coordinate system. If not specified (default), the <code class="docutils literal notranslate"><span class="pre">radesys</span></code>
value is used. For all possible values, see
<a class="reference external" href="http://ds9.si.edu/doc/ref/region.html#RegionFileFormat">http://ds9.si.edu/doc/ref/region.html#RegionFileFormat</a></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.get_axis_types">
<span class="sig-name descname"><span class="pre">get_axis_types</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.get_axis_types" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.get_axis_types'"></a></dt>
<dd><p>Similar to <cite>self.wcsprm.axis_types &lt;astropy.wcs.Wcsprm.axis_types&gt;</cite>
but provides the information in a more Python-friendly format.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>result</strong><span class="classifier">list of dict</span></dt><dd><p>Returns a list of dictionaries, one for each axis, each
containing attributes about the type of that axis.</p>
<p>Each dictionary has the following keys:</p>
<ul class="simple">
<li><p>‘coordinate_type’:</p>
<ul>
<li><p>None: Non-specific coordinate type.</p></li>
<li><p>‘stokes’: Stokes coordinate.</p></li>
<li><p>‘celestial’: Celestial coordinate (including <code class="docutils literal notranslate"><span class="pre">CUBEFACE</span></code>).</p></li>
<li><p>‘spectral’: Spectral coordinate.</p></li>
</ul>
</li>
<li><p>‘scale’:</p>
<ul>
<li><p>‘linear’: Linear axis.</p></li>
<li><p>‘quantized’: Quantized axis (<code class="docutils literal notranslate"><span class="pre">STOKES</span></code>, <code class="docutils literal notranslate"><span class="pre">CUBEFACE</span></code>).</p></li>
<li><p>‘non-linear celestial’: Non-linear celestial axis.</p></li>
<li><p>‘non-linear spectral’: Non-linear spectral axis.</p></li>
<li><p>‘logarithmic’: Logarithmic axis.</p></li>
<li><p>‘tabular’: Tabular axis.</p></li>
</ul>
</li>
<li><p>‘group’</p>
<ul>
<li><p>Group number, e.g. lookup table number</p></li>
</ul>
</li>
<li><p>‘number’</p>
<ul>
<li><p>For celestial axes:</p>
<ul>
<li><p>0: Longitude coordinate.</p></li>
<li><p>1: Latitude coordinate.</p></li>
<li><p>2: <code class="docutils literal notranslate"><span class="pre">CUBEFACE</span></code> number.</p></li>
</ul>
</li>
<li><p>For lookup tables:</p>
<ul>
<li><p>the axis number in a multidimensional table.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">CTYPEia</span></code> in <code class="docutils literal notranslate"><span class="pre">"4-3"</span></code> form with unrecognized algorithm code will
generate an error.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.has_distortion">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_distortion</span></span><a class="headerlink" href="#decontamination.mask.wcs.WCS.has_distortion" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.has_distortion'"></a></dt>
<dd><p>Returns <cite>True</cite> if any distortion terms are present.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.p4_pix2foc">
<span class="sig-name descname"><span class="pre">p4_pix2foc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.p4_pix2foc" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.p4_pix2foc'"></a></dt>
<dd><p>Convert pixel coordinates to focal plane coordinates using
<a href="#id32"><span class="problematic" id="id33">`distortion paper`_</span></a> table-lookup correction.</p>
<p>The output is in absolute pixel coordinates, not relative to
<code class="docutils literal notranslate"><span class="pre">CRPIX</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>result</strong><span class="classifier">array</span></dt><dd><p>Returns the focal coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>MemoryError</dt><dd><p>Memory allocation failed.</p>
</dd>
<dt>ValueError</dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.pix2foc">
<span class="sig-name descname"><span class="pre">pix2foc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.pix2foc" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.pix2foc'"></a></dt>
<dd><p>Convert pixel coordinates to focal plane coordinates using the
<a href="#id34"><span class="problematic" id="id35">`SIP`_</span></a> polynomial distortion convention and <a href="#id36"><span class="problematic" id="id37">`distortion
paper`_</span></a> table-lookup correction.</p>
<p>The output is in absolute pixel coordinates, not relative to
<code class="docutils literal notranslate"><span class="pre">CRPIX</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>result</strong><span class="classifier">array</span></dt><dd><p>Returns the focal coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>MemoryError</dt><dd><p>Memory allocation failed.</p>
</dd>
<dt>ValueError</dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.pixel_axis_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pixel_axis_names</span></span><a class="headerlink" href="#decontamination.mask.wcs.WCS.pixel_axis_names" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.pixel_axis_names'"></a></dt>
<dd><p>An iterable of strings describing the name for each pixel axis.</p>
<p>If an axis does not have a name, an empty string should be returned
(this is the default behavior for all axes if a subclass does not
override this property). Note that these names are just for display
purposes and are not standardized.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.proj_plane_pixel_area">
<span class="sig-name descname"><span class="pre">proj_plane_pixel_area</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.proj_plane_pixel_area" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.proj_plane_pixel_area'"></a></dt>
<dd><p>For a <strong>celestial</strong> WCS (see <cite>astropy.wcs.WCS.celestial</cite>), returns pixel
area of the image pixel at the <code class="docutils literal notranslate"><span class="pre">CRPIX</span></code> location once it is projected
onto the “plane of intermediate world coordinates” as defined in
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2002A%26A...395.1061G">Greisen &amp; Calabretta 2002, A&amp;A, 395, 1061</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is concerned <strong>only</strong> about the transformation
“image plane”-&gt;”projection plane” and <strong>not</strong> about the
transformation “celestial sphere”-&gt;”projection plane”-&gt;”image plane”.
Therefore, this function ignores distortions arising due to
non-linear nature of most projections.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method only returns sensible answers if the WCS contains
celestial axes, i.e., the <cite>~astropy.wcs.WCS.celestial</cite> WCS object.</p>
</div>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>area</strong><span class="classifier"><cite>~astropy.units.Quantity</cite></span></dt><dd><p>Area (in the projection plane) of the pixel at <code class="docutils literal notranslate"><span class="pre">CRPIX</span></code> location.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ValueError</dt><dd><p>Pixel area is defined only for 2D pixels. Most likely the
<cite>~astropy.wcs.Wcsprm.cd</cite> matrix of the <cite>~astropy.wcs.WCS.celestial</cite>
WCS is not a square matrix of second order.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.wcs.utils.proj_plane_pixel_area</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Depending on the application, square root of the pixel area can be used to
represent a single pixel scale of an equivalent square pixel
whose area is equal to the area of a generally non-square pixel.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.proj_plane_pixel_scales">
<span class="sig-name descname"><span class="pre">proj_plane_pixel_scales</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.proj_plane_pixel_scales" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.proj_plane_pixel_scales'"></a></dt>
<dd><p>Calculate pixel scales along each axis of the image pixel at
the <code class="docutils literal notranslate"><span class="pre">CRPIX</span></code> location once it is projected onto the
“plane of intermediate world coordinates” as defined in
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2002A%26A...395.1061G">Greisen &amp; Calabretta 2002, A&amp;A, 395, 1061</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is concerned <strong>only</strong> about the transformation
“image plane”-&gt;”projection plane” and <strong>not</strong> about the
transformation “celestial sphere”-&gt;”projection plane”-&gt;”image plane”.
Therefore, this function ignores distortions arising due to
non-linear nature of most projections.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method only returns sensible answers if the WCS contains
celestial axes, i.e., the <cite>~astropy.wcs.WCS.celestial</cite> WCS object.</p>
</div>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>scale</strong><span class="classifier">list of <cite>~astropy.units.Quantity</cite></span></dt><dd><p>A vector of projection plane increments corresponding to each
pixel side (axis).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.wcs.utils.proj_plane_pixel_scales</span></code></dt><dd></dd>
</dl>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.reorient_celestial_first">
<span class="sig-name descname"><span class="pre">reorient_celestial_first</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.reorient_celestial_first" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.reorient_celestial_first'"></a></dt>
<dd><p>Reorient the WCS such that the celestial axes are first, followed by
the spectral axis, followed by any others.
Assumes at least celestial axes are present.</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.sip">
<span class="sig-name descname"><span class="pre">sip</span></span><a class="headerlink" href="#decontamination.mask.wcs.WCS.sip" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.sip'"></a></dt>
<dd><p>Get/set the <cite>~astropy.wcs.Sip</cite> object for performing <a href="#id38"><span class="problematic" id="id39">`SIP`_</span></a> distortion
correction.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.sip_foc2pix">
<span class="sig-name descname"><span class="pre">sip_foc2pix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.sip_foc2pix" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.sip_foc2pix'"></a></dt>
<dd><p>Convert focal plane coordinates to pixel coordinates using the
<a href="#id40"><span class="problematic" id="id41">`SIP`_</span></a> polynomial distortion convention.</p>
<p>FITS WCS <a href="#id42"><span class="problematic" id="id43">`distortion paper`_</span></a> table lookup distortion
correction is not applied, even if that information existed in
the FITS file that initialized this <cite>~astropy.wcs.WCS</cite> object.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>result</strong><span class="classifier">array</span></dt><dd><p>Returns the pixel coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>MemoryError</dt><dd><p>Memory allocation failed.</p>
</dd>
<dt>ValueError</dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.sip_pix2foc">
<span class="sig-name descname"><span class="pre">sip_pix2foc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.sip_pix2foc" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.sip_pix2foc'"></a></dt>
<dd><p>Convert pixel coordinates to focal plane coordinates using the
<a href="#id44"><span class="problematic" id="id45">`SIP`_</span></a> polynomial distortion convention.</p>
<p>The output is in pixel coordinates, relative to <code class="docutils literal notranslate"><span class="pre">CRPIX</span></code>.</p>
<p>FITS WCS <a href="#id46"><span class="problematic" id="id47">`distortion paper`_</span></a> table lookup correction is not
applied, even if that information existed in the FITS file
that initialized this <code class="xref py py-class docutils literal notranslate"><span class="pre">WCS</span></code> object.  To
correct for that, use <cite>~astropy.wcs.WCS.pix2foc</cite> or
<cite>~astropy.wcs.WCS.p4_pix2foc</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>result</strong><span class="classifier">array</span></dt><dd><p>Returns the focal coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>MemoryError</dt><dd><p>Memory allocation failed.</p>
</dd>
<dt>ValueError</dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.slice">
<span class="sig-name descname"><span class="pre">slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">view</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.slice" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.slice'"></a></dt>
<dd><p>Slice a WCS instance using a Numpy slice. The order of the slice should
be reversed (as for the data) compared to the natural WCS order.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>view</strong><span class="classifier">tuple</span></dt><dd><p>A tuple containing the same number of slices as the WCS system.
The <code class="docutils literal notranslate"><span class="pre">step</span></code> method, the third argument to a slice, is not
presently supported.</p>
</dd>
<dt><strong>numpy_order</strong><span class="classifier">bool</span></dt><dd><p>Use numpy order, i.e. slice the WCS so that an identical slice
applied to a numpy array will slice the array and WCS in the same
way. If set to <cite>False</cite>, the WCS will be sliced in FITS order,
meaning the first slice will be applied to the <em>last</em> numpy index
but the <em>first</em> WCS axis.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>wcs_new</strong><span class="classifier"><cite>~astropy.wcs.WCS</cite></span></dt><dd><p>A new resampled WCS axis</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.spectral">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spectral</span></span><a class="headerlink" href="#decontamination.mask.wcs.WCS.spectral" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.spectral'"></a></dt>
<dd><p>A copy of the current WCS with only the spectral axes included.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.sub">
<span class="sig-name descname"><span class="pre">sub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.sub" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.sub'"></a></dt>
<dd><p>Extracts the coordinate description for a subimage from a
<cite>~astropy.wcs.WCS</cite> object.</p>
<p>The world coordinate system of the subimage must be separable in the
sense that the world coordinates at any point in the subimage must
depend only on the pixel coordinates of the axes extracted.  In
practice, this means that the <code class="docutils literal notranslate"><span class="pre">PCi_ja</span></code> matrix of the original image
must not contain non-zero off-diagonal terms that associate any of the
subimage axes with any of the non-subimage axes.</p>
<p><cite>sub</cite> can also add axes to a wcsprm object.  The new axes will be
created using the defaults set by the Wcsprm constructor which produce
a simple, unnamed, linear axis with world coordinates equal to the
pixel coordinate.  These default values can be changed before
invoking <cite>set</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>axes</strong><span class="classifier">int or a sequence.</span></dt><dd><ul class="simple">
<li><p>If an int, include the first <em>N</em> axes in their original order.</p></li>
<li><p>If a sequence, may contain a combination of image axis numbers
(1-relative) or special axis identifiers (see below).  Order is
significant; <code class="docutils literal notranslate"><span class="pre">axes[0]</span></code> is the axis number of the input image
that corresponds to the first axis in the subimage, etc.  Use an
axis number of 0 to create a new axis using the defaults.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">[]</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, do a deep copy.</p></li>
</ul>
<p>Coordinate axes types may be specified using either strings or
special integer constants.  The available types are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'longitude'</span></code> / <code class="docutils literal notranslate"><span class="pre">WCSSUB_LONGITUDE</span></code>: Celestial longitude</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'latitude'</span></code> / <code class="docutils literal notranslate"><span class="pre">WCSSUB_LATITUDE</span></code>: Celestial latitude</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'cubeface'</span></code> / <code class="docutils literal notranslate"><span class="pre">WCSSUB_CUBEFACE</span></code>: Quadcube <code class="docutils literal notranslate"><span class="pre">CUBEFACE</span></code> axis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'spectral'</span></code> / <code class="docutils literal notranslate"><span class="pre">WCSSUB_SPECTRAL</span></code>: Spectral axis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'stokes'</span></code> / <code class="docutils literal notranslate"><span class="pre">WCSSUB_STOKES</span></code>: Stokes axis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'temporal'</span></code> / <code class="docutils literal notranslate"><span class="pre">WCSSUB_TIME</span></code>: Time axis (requires <code class="docutils literal notranslate"><span class="pre">WCSLIB</span></code> version 7.8 or greater)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'celestial'</span></code> / <code class="docutils literal notranslate"><span class="pre">WCSSUB_CELESTIAL</span></code>: An alias for the
combination of <code class="docutils literal notranslate"><span class="pre">'longitude'</span></code>, <code class="docutils literal notranslate"><span class="pre">'latitude'</span></code> and <code class="docutils literal notranslate"><span class="pre">'cubeface'</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>new_wcs</strong><span class="classifier"><cite>~astropy.wcs.WCS</cite> object</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>MemoryError</dt><dd><p>Memory allocation failed.</p>
</dd>
<dt>InvalidSubimageSpecificationError</dt><dd><p>Invalid subimage specification (no spectral axis).</p>
</dd>
<dt>NonseparableSubimageCoordinateSystemError</dt><dd><p>Non-separable subimage coordinate system.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Combinations of subimage axes of particular types may be extracted in
the same order as they occur in the input image by combining the
integer constants with the ‘binary or’ (<code class="docutils literal notranslate"><span class="pre">|</span></code>) operator.  For
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">wcs</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="n">WCSSUB_LONGITUDE</span> <span class="o">|</span> <span class="n">WCSSUB_LATITUDE</span> <span class="o">|</span> <span class="n">WCSSUB_SPECTRAL</span><span class="p">])</span>
</span></code></pre></div>
</div>
<p>would extract the longitude, latitude, and spectral axes in the same
order as the input image.  If one of each were present, the resulting
object would have three dimensions.</p>
<p>For convenience, <code class="docutils literal notranslate"><span class="pre">WCSSUB_CELESTIAL</span></code> is defined as the combination
<code class="docutils literal notranslate"><span class="pre">WCSSUB_LONGITUDE</span> <span class="pre">|</span> <span class="pre">WCSSUB_LATITUDE</span> <span class="pre">|</span> <span class="pre">WCSSUB_CUBEFACE</span></code>.</p>
<p>The codes may also be negated to extract all but the types specified,
for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">wcs</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span>
</span><span id="line-2">  <span class="n">WCSSUB_LONGITUDE</span><span class="p">,</span>
</span><span id="line-3">  <span class="n">WCSSUB_LATITUDE</span><span class="p">,</span>
</span><span id="line-4">  <span class="n">WCSSUB_CUBEFACE</span><span class="p">,</span>
</span><span id="line-5">  <span class="o">-</span><span class="p">(</span><span class="n">WCSSUB_SPECTRAL</span> <span class="o">|</span> <span class="n">WCSSUB_STOKES</span><span class="p">)])</span>
</span></code></pre></div>
</div>
<p>The last of these specifies all axis types other than spectral or
Stokes.  Extraction is done in the order specified by <code class="docutils literal notranslate"><span class="pre">axes</span></code>, i.e. a
longitude axis (if present) would be extracted first (via <code class="docutils literal notranslate"><span class="pre">axes[0]</span></code>)
and not subsequently (via <code class="docutils literal notranslate"><span class="pre">axes[3]</span></code>).  Likewise for the latitude and
cubeface axes in this example.</p>
<p>The number of dimensions in the returned object may be less than or
greater than the length of <code class="docutils literal notranslate"><span class="pre">axes</span></code>.  However, it will never exceed the
number of axes in the input image.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.swapaxes">
<span class="sig-name descname"><span class="pre">swapaxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.swapaxes" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.swapaxes'"></a></dt>
<dd><p>Swap axes in a WCS.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>wcs</strong><span class="classifier"><cite>~astropy.wcs.WCS</cite></span></dt><dd><p>The WCS to have its axes swapped</p>
</dd>
<dt><strong>ax0</strong><span class="classifier">int</span></dt><dd></dd>
<dt><strong>ax1</strong><span class="classifier">int</span></dt><dd><p>The indices of the WCS to be swapped, counting from 0 (i.e., python
convention, not FITS convention)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><cite>~astropy.wcs.WCS</cite></dt><dd><p>A new <cite>~astropy.wcs.WCS</cite> instance with the same number of axes,
but two swapped</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.temporal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">temporal</span></span><a class="headerlink" href="#decontamination.mask.wcs.WCS.temporal" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.temporal'"></a></dt>
<dd><p>A copy of the current WCS with only the time axes included.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.to_fits">
<span class="sig-name descname"><span class="pre">to_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.to_fits" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.to_fits'"></a></dt>
<dd><p>Generate an <cite>~astropy.io.fits.HDUList</cite> object with all of the
information stored in this object.  This should be logically identical
to the input FITS file, but it will be normalized in a number of ways.</p>
<p>See <cite>to_header</cite> for some warnings about the output produced.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>relax</strong><span class="classifier">bool or int, optional</span></dt><dd><p>Degree of permissiveness:</p>
<ul class="simple">
<li><p><cite>False</cite> (default): Write all extensions that are
considered to be safe and recommended.</p></li>
<li><p><cite>True</cite>: Write all recognized informal extensions of the
WCS standard.</p></li>
<li><p><cite>int</cite>: a bit field selecting specific extensions to
write.  See <span class="xref std std-ref">astropy:relaxwrite</span> for details.</p></li>
</ul>
</dd>
<dt><strong>key</strong><span class="classifier">str</span></dt><dd><p>The name of a particular WCS transform to use.  This may be
either <code class="docutils literal notranslate"><span class="pre">'</span> <span class="pre">'</span></code> or <code class="docutils literal notranslate"><span class="pre">'A'</span></code>-<code class="docutils literal notranslate"><span class="pre">'Z'</span></code> and corresponds to the <code class="docutils literal notranslate"><span class="pre">"a"</span></code>
part of the <code class="docutils literal notranslate"><span class="pre">CTYPEia</span></code> cards.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>hdulist</strong><span class="classifier"><cite>~astropy.io.fits.HDUList</cite></span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.to_header">
<span class="sig-name descname"><span class="pre">to_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.to_header" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.to_header'"></a></dt>
<dd><p>Generate an <cite>astropy.io.fits.Header</cite> object with the basic WCS
and SIP information stored in this object.  This should be
logically identical to the input FITS file, but it will be
normalized in a number of ways.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function does not write out FITS WCS <a href="#id48"><span class="problematic" id="id49">`distortion
paper`_</span></a> information, since that requires multiple FITS
header data units.  To get a full representation of
everything in this object, use <cite>to_fits</cite>.</p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>relax</strong><span class="classifier">bool or int, optional</span></dt><dd><p>Degree of permissiveness:</p>
<ul class="simple">
<li><p><cite>False</cite> (default): Write all extensions that are
considered to be safe and recommended.</p></li>
<li><p><cite>True</cite>: Write all recognized informal extensions of the
WCS standard.</p></li>
<li><p><cite>int</cite>: a bit field selecting specific extensions to
write.  See <span class="xref std std-ref">astropy:relaxwrite</span> for details.</p></li>
</ul>
<p>If the <code class="docutils literal notranslate"><span class="pre">relax</span></code> keyword argument is not given and any
keywords were omitted from the output, an
<cite>~astropy.utils.exceptions.AstropyWarning</cite> is displayed.
To override this, explicitly pass a value to <code class="docutils literal notranslate"><span class="pre">relax</span></code>.</p>
</dd>
<dt><strong>key</strong><span class="classifier">str</span></dt><dd><p>The name of a particular WCS transform to use.  This may be
either <code class="docutils literal notranslate"><span class="pre">'</span> <span class="pre">'</span></code> or <code class="docutils literal notranslate"><span class="pre">'A'</span></code>-<code class="docutils literal notranslate"><span class="pre">'Z'</span></code> and corresponds to the <code class="docutils literal notranslate"><span class="pre">"a"</span></code>
part of the <code class="docutils literal notranslate"><span class="pre">CTYPEia</span></code> cards.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>header</strong><span class="classifier"><cite>astropy.io.fits.Header</cite></span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The output header will almost certainly differ from the input in a
number of respects:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The output header only contains WCS-related keywords.  In
particular, it does not contain syntactically-required
keywords such as <code class="docutils literal notranslate"><span class="pre">SIMPLE</span></code>, <code class="docutils literal notranslate"><span class="pre">NAXIS</span></code>, <code class="docutils literal notranslate"><span class="pre">BITPIX</span></code>, or
<code class="docutils literal notranslate"><span class="pre">END</span></code>.</p></li>
<li><p>Deprecated (e.g. <code class="docutils literal notranslate"><span class="pre">CROTAn</span></code>) or non-standard usage will
be translated to standard (this is partially dependent on
whether <code class="docutils literal notranslate"><span class="pre">fix</span></code> was applied).</p></li>
<li><p>Quantities will be converted to the units used internally,
basically SI with the addition of degrees.</p></li>
<li><p>Floating-point quantities may be given to a different decimal
precision.</p></li>
<li><p>Elements of the <code class="docutils literal notranslate"><span class="pre">PCi_j</span></code> matrix will be written if and
only if they differ from the unit matrix.  Thus, if the
matrix is unity then no elements will be written.</p></li>
<li><p>Additional keywords such as <code class="docutils literal notranslate"><span class="pre">WCSAXES</span></code>, <code class="docutils literal notranslate"><span class="pre">CUNITia</span></code>,
<code class="docutils literal notranslate"><span class="pre">LONPOLEa</span></code> and <code class="docutils literal notranslate"><span class="pre">LATPOLEa</span></code> may appear.</p></li>
<li><p>The original keycomments will be lost, although
<cite>to_header</cite> tries hard to write meaningful comments.</p></li>
<li><p>Keyword order may be changed.</p></li>
</ol>
</div></blockquote>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.to_header_string">
<span class="sig-name descname"><span class="pre">to_header_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.to_header_string" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.to_header_string'"></a></dt>
<dd><p>Identical to <cite>to_header</cite>, but returns a string containing the
header cards.</p>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.wcs">
<span class="sig-name descname"><span class="pre">wcs</span></span><a class="headerlink" href="#decontamination.mask.wcs.WCS.wcs" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.wcs'"></a></dt>
<dd><p>A <cite>~astropy.wcs.Wcsprm</cite> object to perform the basic <a href="#id50"><span class="problematic" id="id51">`wcslib`_</span></a> WCS
transformation.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.wcs_pix2world">
<span class="sig-name descname"><span class="pre">wcs_pix2world</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.wcs_pix2world" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.wcs_pix2world'"></a></dt>
<dd><p>Transforms pixel coordinates to world coordinates by doing
only the basic <a href="#id52"><span class="problematic" id="id53">`wcslib`_</span></a> transformation.</p>
<p>No <a href="#id54"><span class="problematic" id="id55">`SIP`_</span></a> or <a href="#id56"><span class="problematic" id="id57">`distortion paper`_</span></a> table lookup correction is
applied.  To perform distortion correction, see
<cite>~astropy.wcs.WCS.all_pix2world</cite>,
<cite>~astropy.wcs.WCS.sip_pix2foc</cite>, <cite>~astropy.wcs.WCS.p4_pix2foc</cite>,
or <cite>~astropy.wcs.WCS.pix2foc</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>naxis</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
<p>For a transformation that is not two-dimensional, the
two-argument form must be used.</p>
</dd>
<dt><strong>ra_dec_order</strong><span class="classifier">bool, optional</span></dt><dd><p>When <cite>True</cite> will ensure that world coordinates are always given
and returned in as (<em>ra</em>, <em>dec</em>) pairs, regardless of the order of
the axes specified by the in the <code class="docutils literal notranslate"><span class="pre">CTYPE</span></code> keywords.  Default is
<cite>False</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>result</strong><span class="classifier">array</span></dt><dd><p>Returns the world coordinates, in degrees.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>MemoryError</dt><dd><p>Memory allocation failed.</p>
</dd>
<dt>SingularMatrixError</dt><dd><p>Linear transformation matrix is singular.</p>
</dd>
<dt>InconsistentAxisTypesError</dt><dd><p>Inconsistent or unrecognized coordinate axis types.</p>
</dd>
<dt>ValueError</dt><dd><p>Invalid parameter value.</p>
</dd>
<dt>ValueError</dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
<dt>ValueError</dt><dd><p>x- and y-coordinate arrays are not the same size.</p>
</dd>
<dt>InvalidTransformError</dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
<dt>InvalidTransformError</dt><dd><p>Ill-conditioned coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The order of the axes for the result is determined by the
<code class="docutils literal notranslate"><span class="pre">CTYPEia</span></code> keywords in the FITS header, therefore it may not
always be of the form (<em>ra</em>, <em>dec</em>).  The
<cite>~astropy.wcs.Wcsprm.lat</cite>, <cite>~astropy.wcs.Wcsprm.lng</cite>,
<cite>~astropy.wcs.Wcsprm.lattyp</cite> and <cite>~astropy.wcs.Wcsprm.lngtyp</cite>
members can be used to determine the order of the axes.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.wcs_world2pix">
<span class="sig-name descname"><span class="pre">wcs_world2pix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.wcs_world2pix" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.wcs_world2pix'"></a></dt>
<dd><p>Transforms world coordinates to pixel coordinates, using only
the basic <a href="#id58"><span class="problematic" id="id59">`wcslib`_</span></a> WCS transformation.  No <a href="#id60"><span class="problematic" id="id61">`SIP`_</span></a> or
<a href="#id62"><span class="problematic" id="id63">`distortion paper`_</span></a> table lookup transformation is applied.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>naxis</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
<p>For a transformation that is not two-dimensional, the
two-argument form must be used.</p>
</dd>
<dt><strong>ra_dec_order</strong><span class="classifier">bool, optional</span></dt><dd><p>When <cite>True</cite> will ensure that world coordinates are always given
and returned in as (<em>ra</em>, <em>dec</em>) pairs, regardless of the order of
the axes specified by the in the <code class="docutils literal notranslate"><span class="pre">CTYPE</span></code> keywords.  Default is
<cite>False</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>result</strong><span class="classifier">array</span></dt><dd><p>Returns the pixel coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>MemoryError</dt><dd><p>Memory allocation failed.</p>
</dd>
<dt>SingularMatrixError</dt><dd><p>Linear transformation matrix is singular.</p>
</dd>
<dt>InconsistentAxisTypesError</dt><dd><p>Inconsistent or unrecognized coordinate axis types.</p>
</dd>
<dt>ValueError</dt><dd><p>Invalid parameter value.</p>
</dd>
<dt>ValueError</dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
<dt>ValueError</dt><dd><p>x- and y-coordinate arrays are not the same size.</p>
</dd>
<dt>InvalidTransformError</dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
<dt>InvalidTransformError</dt><dd><p>Ill-conditioned coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The order of the axes for the input world array is determined by
the <code class="docutils literal notranslate"><span class="pre">CTYPEia</span></code> keywords in the FITS header, therefore it may
not always be of the form (<em>ra</em>, <em>dec</em>).  The
<cite>~astropy.wcs.Wcsprm.lat</cite>, <cite>~astropy.wcs.Wcsprm.lng</cite>,
<cite>~astropy.wcs.Wcsprm.lattyp</cite> and <cite>~astropy.wcs.Wcsprm.lngtyp</cite>
members can be used to determine the order of the axes.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.world_to_array_index">
<span class="sig-name descname"><span class="pre">world_to_array_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">world_objects</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.world_to_array_index" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.world_to_array_index'"></a></dt>
<dd><p>Convert world coordinates (represented by Astropy objects) to array
indices.</p>
<p>If <cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim</cite> is <code class="docutils literal notranslate"><span class="pre">1</span></code>, this
method returns a single scalar or array, otherwise a tuple of scalars or
arrays is returned. See
<cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.world_to_array_index_values</cite> for
pixel indexing and ordering conventions. The indices should be returned
as rounded integers.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.world_to_array_index_values">
<span class="sig-name descname"><span class="pre">world_to_array_index_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">world_arrays</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#decontamination.mask.wcs.WCS.world_to_array_index_values" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.world_to_array_index_values'"></a></dt>
<dd><p>Convert world coordinates to array indices.</p>
<p>This is the same as <cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.world_to_pixel_values</cite> except that
the indices should be returned in <code class="docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">j)</span></code> order, where for an image
<code class="docutils literal notranslate"><span class="pre">i</span></code> is the row and <code class="docutils literal notranslate"><span class="pre">j</span></code> is the column (i.e. the opposite order to
<cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_to_world_values</cite>). The indices should be
returned as rounded integers.</p>
<p>If <cite>~astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim</cite> is <code class="docutils literal notranslate"><span class="pre">1</span></code>, this
method returns a single scalar or array, otherwise a tuple of scalars or
arrays is returned.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.all_pix2world">
<span class="sig-name descname"><span class="pre">all_pix2world</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#decontamination.mask.wcs.WCS.all_pix2world" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.all_pix2world'"></a></dt>
<dd><p>Thread-safe version of <cite>astropy.wcs.WCS.all_pix2world</cite>.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="decontamination.mask.wcs.WCS.all_world2pix">
<span class="sig-name descname"><span class="pre">all_world2pix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#decontamination.mask.wcs.WCS.all_world2pix" title="Link to this definition" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#decontamination.mask.wcs.WCS.all_world2pix'"></a></dt>
<dd><p>Thread-safe version of <cite>astropy.wcs.WCS.all_world2pix</cite>.</p>
</dd></dl>
</dd></dl>
</section>
</section>
</div></div><aside class="hidden text-sm xl:block" id="right-sidebar">
<div class="sticky top-16 -mt-10 max-h-[calc(100vh-5rem)] overflow-y-auto pt-6 space-y-2"><p class="font-medium">On this page</p>
<ul>
<li><a :data-current="activeSection === '#module-decontamination.mask.healpix'" class="reference internal" href="#module-decontamination.mask.healpix">HEALPix masks</a><ul>
<li><a :data-current="activeSection === '#decontamination.mask.healpix.rms_bit_to_healpix'" class="reference internal" href="#decontamination.mask.healpix.rms_bit_to_healpix"><code class="docutils literal notranslate"><span class="pre">rms_bit_to_healpix()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.healpix.image_to_healpix'" class="reference internal" href="#decontamination.mask.healpix.image_to_healpix"><code class="docutils literal notranslate"><span class="pre">image_to_healpix()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#module-decontamination.mask.moc'" class="reference internal" href="#module-decontamination.mask.moc">Multi-Order Coverage (MOC) masks</a><ul>
<li><a :data-current="activeSection === '#decontamination.mask.moc.order_index_to_nuniq'" class="reference internal" href="#decontamination.mask.moc.order_index_to_nuniq"><code class="docutils literal notranslate"><span class="pre">order_index_to_nuniq()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.moc.nuniq_to_order_index'" class="reference internal" href="#decontamination.mask.moc.nuniq_to_order_index"><code class="docutils literal notranslate"><span class="pre">nuniq_to_order_index()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.moc.moc_to_healpix'" class="reference internal" href="#decontamination.mask.moc.moc_to_healpix"><code class="docutils literal notranslate"><span class="pre">moc_to_healpix()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.moc.wmoc_to_healpix'" class="reference internal" href="#decontamination.mask.moc.wmoc_to_healpix"><code class="docutils literal notranslate"><span class="pre">wmoc_to_healpix()</span></code></a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#module-decontamination.mask.wcs'" class="reference internal" href="#module-decontamination.mask.wcs">World Coordinate System (WCS)</a><ul>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS'" class="reference internal" href="#decontamination.mask.wcs.WCS"><code class="docutils literal notranslate"><span class="pre">WCS</span></code></a><ul>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.MUTEX'" class="reference internal" href="#decontamination.mask.wcs.WCS.MUTEX"><code class="docutils literal notranslate"><span class="pre">WCS.MUTEX</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.array_index_to_world'" class="reference internal" href="#decontamination.mask.wcs.WCS.array_index_to_world"><code class="docutils literal notranslate"><span class="pre">WCS.array_index_to_world()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.array_index_to_world_values'" class="reference internal" href="#decontamination.mask.wcs.WCS.array_index_to_world_values"><code class="docutils literal notranslate"><span class="pre">WCS.array_index_to_world_values()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.axis_type_names'" class="reference internal" href="#decontamination.mask.wcs.WCS.axis_type_names"><code class="docutils literal notranslate"><span class="pre">WCS.axis_type_names</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.calc_footprint'" class="reference internal" href="#decontamination.mask.wcs.WCS.calc_footprint"><code class="docutils literal notranslate"><span class="pre">WCS.calc_footprint()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.celestial'" class="reference internal" href="#decontamination.mask.wcs.WCS.celestial"><code class="docutils literal notranslate"><span class="pre">WCS.celestial</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.copy'" class="reference internal" href="#decontamination.mask.wcs.WCS.copy"><code class="docutils literal notranslate"><span class="pre">WCS.copy()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.cpdis1'" class="reference internal" href="#decontamination.mask.wcs.WCS.cpdis1"><code class="docutils literal notranslate"><span class="pre">WCS.cpdis1</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.cpdis2'" class="reference internal" href="#decontamination.mask.wcs.WCS.cpdis2"><code class="docutils literal notranslate"><span class="pre">WCS.cpdis2</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.deepcopy'" class="reference internal" href="#decontamination.mask.wcs.WCS.deepcopy"><code class="docutils literal notranslate"><span class="pre">WCS.deepcopy()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.det2im'" class="reference internal" href="#decontamination.mask.wcs.WCS.det2im"><code class="docutils literal notranslate"><span class="pre">WCS.det2im()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.det2im1'" class="reference internal" href="#decontamination.mask.wcs.WCS.det2im1"><code class="docutils literal notranslate"><span class="pre">WCS.det2im1</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.det2im2'" class="reference internal" href="#decontamination.mask.wcs.WCS.det2im2"><code class="docutils literal notranslate"><span class="pre">WCS.det2im2</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.dropaxis'" class="reference internal" href="#decontamination.mask.wcs.WCS.dropaxis"><code class="docutils literal notranslate"><span class="pre">WCS.dropaxis()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.fix'" class="reference internal" href="#decontamination.mask.wcs.WCS.fix"><code class="docutils literal notranslate"><span class="pre">WCS.fix()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.footprint_contains'" class="reference internal" href="#decontamination.mask.wcs.WCS.footprint_contains"><code class="docutils literal notranslate"><span class="pre">WCS.footprint_contains()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.footprint_to_file'" class="reference internal" href="#decontamination.mask.wcs.WCS.footprint_to_file"><code class="docutils literal notranslate"><span class="pre">WCS.footprint_to_file()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.get_axis_types'" class="reference internal" href="#decontamination.mask.wcs.WCS.get_axis_types"><code class="docutils literal notranslate"><span class="pre">WCS.get_axis_types()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.has_distortion'" class="reference internal" href="#decontamination.mask.wcs.WCS.has_distortion"><code class="docutils literal notranslate"><span class="pre">WCS.has_distortion</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.p4_pix2foc'" class="reference internal" href="#decontamination.mask.wcs.WCS.p4_pix2foc"><code class="docutils literal notranslate"><span class="pre">WCS.p4_pix2foc()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.pix2foc'" class="reference internal" href="#decontamination.mask.wcs.WCS.pix2foc"><code class="docutils literal notranslate"><span class="pre">WCS.pix2foc()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.pixel_axis_names'" class="reference internal" href="#decontamination.mask.wcs.WCS.pixel_axis_names"><code class="docutils literal notranslate"><span class="pre">WCS.pixel_axis_names</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.proj_plane_pixel_area'" class="reference internal" href="#decontamination.mask.wcs.WCS.proj_plane_pixel_area"><code class="docutils literal notranslate"><span class="pre">WCS.proj_plane_pixel_area()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.proj_plane_pixel_scales'" class="reference internal" href="#decontamination.mask.wcs.WCS.proj_plane_pixel_scales"><code class="docutils literal notranslate"><span class="pre">WCS.proj_plane_pixel_scales()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.reorient_celestial_first'" class="reference internal" href="#decontamination.mask.wcs.WCS.reorient_celestial_first"><code class="docutils literal notranslate"><span class="pre">WCS.reorient_celestial_first()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.sip'" class="reference internal" href="#decontamination.mask.wcs.WCS.sip"><code class="docutils literal notranslate"><span class="pre">WCS.sip</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.sip_foc2pix'" class="reference internal" href="#decontamination.mask.wcs.WCS.sip_foc2pix"><code class="docutils literal notranslate"><span class="pre">WCS.sip_foc2pix()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.sip_pix2foc'" class="reference internal" href="#decontamination.mask.wcs.WCS.sip_pix2foc"><code class="docutils literal notranslate"><span class="pre">WCS.sip_pix2foc()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.slice'" class="reference internal" href="#decontamination.mask.wcs.WCS.slice"><code class="docutils literal notranslate"><span class="pre">WCS.slice()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.spectral'" class="reference internal" href="#decontamination.mask.wcs.WCS.spectral"><code class="docutils literal notranslate"><span class="pre">WCS.spectral</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.sub'" class="reference internal" href="#decontamination.mask.wcs.WCS.sub"><code class="docutils literal notranslate"><span class="pre">WCS.sub()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.swapaxes'" class="reference internal" href="#decontamination.mask.wcs.WCS.swapaxes"><code class="docutils literal notranslate"><span class="pre">WCS.swapaxes()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.temporal'" class="reference internal" href="#decontamination.mask.wcs.WCS.temporal"><code class="docutils literal notranslate"><span class="pre">WCS.temporal</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.to_fits'" class="reference internal" href="#decontamination.mask.wcs.WCS.to_fits"><code class="docutils literal notranslate"><span class="pre">WCS.to_fits()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.to_header'" class="reference internal" href="#decontamination.mask.wcs.WCS.to_header"><code class="docutils literal notranslate"><span class="pre">WCS.to_header()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.to_header_string'" class="reference internal" href="#decontamination.mask.wcs.WCS.to_header_string"><code class="docutils literal notranslate"><span class="pre">WCS.to_header_string()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.wcs'" class="reference internal" href="#decontamination.mask.wcs.WCS.wcs"><code class="docutils literal notranslate"><span class="pre">WCS.wcs</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.wcs_pix2world'" class="reference internal" href="#decontamination.mask.wcs.WCS.wcs_pix2world"><code class="docutils literal notranslate"><span class="pre">WCS.wcs_pix2world()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.wcs_world2pix'" class="reference internal" href="#decontamination.mask.wcs.WCS.wcs_world2pix"><code class="docutils literal notranslate"><span class="pre">WCS.wcs_world2pix()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.world_to_array_index'" class="reference internal" href="#decontamination.mask.wcs.WCS.world_to_array_index"><code class="docutils literal notranslate"><span class="pre">WCS.world_to_array_index()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.world_to_array_index_values'" class="reference internal" href="#decontamination.mask.wcs.WCS.world_to_array_index_values"><code class="docutils literal notranslate"><span class="pre">WCS.world_to_array_index_values()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.all_pix2world'" class="reference internal" href="#decontamination.mask.wcs.WCS.all_pix2world"><code class="docutils literal notranslate"><span class="pre">WCS.all_pix2world()</span></code></a></li>
<li><a :data-current="activeSection === '#decontamination.mask.wcs.WCS.all_world2pix'" class="reference internal" href="#decontamination.mask.wcs.WCS.all_world2pix"><code class="docutils literal notranslate"><span class="pre">WCS.all_world2pix()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</aside>
</main>
</div>
</div><footer class="py-6 border-t border-border md:py-0">
<div class="container flex flex-col items-center justify-between gap-4 md:h-24 md:flex-row">
<div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0">
<p class="text-sm leading-loose text-center text-muted-foreground md:text-left">© 2023-2024, CNRS/LPSC Built with <a class="font-medium underline underline-offset-4" href="https://www.sphinx-doc.org" rel="noreferrer">Sphinx 8.0.2</a></p>
</div>
</div>
</footer>
</div>
<script src="_static/documentation_options.js?v=d45e8c67"></script>
<script src="_static/doctools.js?v=9a2dae69"></script>
<script src="_static/sphinx_highlight.js?v=dc90522c"></script>
<script defer="defer" src="_static/theme.js?v=1808ab49"></script>
<script defer="defer" src="_static/docsearch.js?v=711ed680"></script>
<script defer="defer" src="_static/docsearch_config.js?v=0d163087"></script>
<script src="_static/custom.js?v=3685ffa6"></script>
</body>
</html>