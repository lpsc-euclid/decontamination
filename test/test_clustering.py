#!/usr/bin/env python3 -m pytest
# -*- coding: utf-8 -*-
########################################################################################################################

import os
import sys

sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), '..')))

########################################################################################################################

import decontamination

import numpy as np

########################################################################################################################

def test_clusterize():

    n_clusters = 10

    np.random.seed(0)

    data = np.random.rand(100, 100).astype(np.float32)

    expected_cluster_ids = np.array([
        0, 1, 2, 3, 4, 5, 6, 1, 7, 1,
        1, 4, 6, 7, 3, 8, 1, 8, 5, 8,
        3, 9, 9, 9, 1, 1, 6, 9, 1, 8,
        1, 0, 4, 1, 3, 5, 2, 6, 5, 2,
        6, 7, 5, 6, 3, 3, 4, 0, 9, 9,
        0, 0, 7, 6, 0, 9, 9, 0, 9, 9,
        5, 1, 3, 0, 6, 0, 3, 7, 7, 9,
        6, 7, 7, 1, 7, 7, 1, 0, 0, 1,
        1, 1, 5, 1, 9, 9, 2, 6, 5, 2,
        5, 3, 6, 4, 0, 3, 3, 1, 9, 4,
    ])

    cluster_ids = decontamination.Clustering.clusterize(data, n_clusters)

    assert np.array_equal(cluster_ids, expected_cluster_ids)

########################################################################################################################
